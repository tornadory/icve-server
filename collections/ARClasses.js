ARClasses = new Meteor.Collection('arclasses');

ARClasses.allow({
  insert: function(userId, doc){
    return !!userId;
  }
});

ARClassSchema = new SimpleSchema({
  name: {
    type: String,
    label: "课程名",
    autoform: {
      afFieldInput: {
        class: 'text'
      }
    }
  },
  title: {
    type: String,
    label: "课程标题"
  },
  icon: {
    type: String,
    label: "课程图标",
    autoform: {
      afFieldInput: {
        type: 'fileUpload',
        collection: 'Images'
      }
    }
  },
  url: {
    type: String,
    label: "课程链接",
    autoform: {
      afFieldInput: {
        class: 'text'
      }
    }
  },
  subject: {
    type: String, //[] for multiple selection
    label: "所属科目分类",

    autoform: {
        options: function() {
            var opts = Subjects.find().map(function(entity) {
                return {
                    label: entity.name,
                    value: entity._id
                };
            });
            return opts;
        }
    }

    // allowedValues: ['机械制造与自动化', '物联网应用技术', '机电一体化', '工业机器人技术','计算机应用技术', '航空工程技术'],
    // autoform: {
    //   options: {
    //     sid1: "机械制造与自动化",
    //     sid2: "物联网应用技术",
    //     sid3: "机电一体化",
    //     sid4: "工业机器人技术",
    //     sid5: "计算机应用技术",
    //     sid6: "航空工程技术"
    //   }
    // }

    // optional: true,
    // autoform: {
    //   type: 'select2',
    //   afFieldInput: {
    //     class: 'text'
    //   },
    //   // options: function(){
    //   //   return Subjects.find().fetch();
    //   // },
    //   // placeholder: 'Comma spaced list of occupations'
    // }
  },
  author: {
    type: String,
    label: "作者",
    autoValue: function(){
      return this.userId;
    },
    autoform: {
      type: "hidden"
    }
  },
  createdAt: {
    type: Date,
    label: "创建时间",
    autoValue: function(){
      return new Date();
    },
    autoform: {
      type: "hidden"
    }
  }
});

ARClasses.attachSchema(ARClassSchema);
